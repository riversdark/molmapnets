---

title: nets


keywords: fastai
sidebar: home_sidebar

summary: "The neural network architects."
description: "The neural network architects."
nb_path: "03_nets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_nets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/olivier/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint8 = np.dtype([(&#34;qint8&#34;, np.int8, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint8 = np.dtype([(&#34;quint8&#34;, np.uint8, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint16 = np.dtype([(&#34;qint16&#34;, np.int16, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint16 = np.dtype([(&#34;quint16&#34;, np.uint16, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint32 = np.dtype([(&#34;qint32&#34;, np.int32, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  np_resource = np.dtype([(&#34;resource&#34;, np.ubyte, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint8 = np.dtype([(&#34;qint8&#34;, np.int8, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint8 = np.dtype([(&#34;quint8&#34;, np.uint8, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint16 = np.dtype([(&#34;qint16&#34;, np.int16, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint16 = np.dtype([(&#34;quint16&#34;, np.uint16, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint32 = np.dtype([(&#34;qint32&#34;, np.int32, 1)])
/Users/olivier/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  np_resource = np.dtype([(&#34;resource&#34;, np.ubyte, 1)])
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Count-trainable-parameters-in-model">Count trainable parameters in model<a class="anchor-link" href="#Count-trainable-parameters-in-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="count_trainable_params" class="doc_header"><code>count_trainable_params</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>count_trainable_params</code>(<strong><code>model</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resnet-block">Resnet block<a class="anchor-link" href="#Resnet-block"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resnet_block" class="doc_header"><code>resnet_block</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resnet_block</code>(<strong><code>input_data</code></strong>, <strong><code>filters</code></strong>, <strong><code>conv_size</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Inception">Inception<a class="anchor-link" href="#Inception"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Inception" class="doc_header"><code>Inception</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L39" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Inception</code>(<strong><code>inputs</code></strong>, <strong><code>units</code></strong>=<em><code>8</code></em>, <strong><code>strides</code></strong>=<em><code>1</code></em>)</p>
</blockquote>
<p>naive google inception block</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Molecular-Mapping-network">Molecular Mapping network<a class="anchor-link" href="#Molecular-Mapping-network"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MolMapNet" class="doc_header"><code>MolMapNet</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MolMapNet</code>(<strong><code>input_shape</code></strong>, <strong><code>n_outputs</code></strong>=<em><code>1</code></em>, <strong><code>conv1_kernel_size</code></strong>=<em><code>13</code></em>, <strong><code>dense_layers</code></strong>=<em><code>[128, 32]</code></em>, <strong><code>dense_avf</code></strong>=<em><code>'relu'</code></em>, <strong><code>last_avf</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><p>molmap_shape: w, h, c
n_outputs: output units
dense_layers: list, how many dense layers and units
dense_avf: activation function for dense layers
last_avf: activation function for last layer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dual-path-Molecular-Mapping-network">Dual path Molecular Mapping network<a class="anchor-link" href="#Dual-path-Molecular-Mapping-network"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MolMapDualPathNet" class="doc_header"><code>MolMapDualPathNet</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MolMapDualPathNet</code>(<strong><code>molmap1_size</code></strong>, <strong><code>molmap2_size</code></strong>, <strong><code>n_outputs</code></strong>=<em><code>1</code></em>, <strong><code>conv1_kernel_size</code></strong>=<em><code>13</code></em>, <strong><code>dense_layers</code></strong>=<em><code>[256, 128, 32]</code></em>, <strong><code>dense_avf</code></strong>=<em><code>'relu'</code></em>, <strong><code>last_avf</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><p>molmap1_size: w, h, c, shape of first molmap
molmap2_size: w, h, c, shape of second molmap
n_outputs: output units
dense_layers: list, how many dense layers and units
dense_avf: activation function for dense layers
last_avf: activation function for last layer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Additive-path-Molecular-Mapping-network">Additive path Molecular Mapping network<a class="anchor-link" href="#Additive-path-Molecular-Mapping-network"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MolMapAddPathNet" class="doc_header"><code>MolMapAddPathNet</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L146" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MolMapAddPathNet</code>(<strong><code>molmap_shape</code></strong>, <strong><code>additional_shape</code></strong>, <strong><code>n_outputs</code></strong>=<em><code>1</code></em>, <strong><code>dense_layers</code></strong>=<em><code>[128, 32]</code></em>, <strong><code>dense_avf</code></strong>=<em><code>'relu'</code></em>, <strong><code>last_avf</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><p>molmap_shape: w, h, c
n_outputs: output units
dense_layers: list, how many dense layers and units
dense_avf: activation function for dense layers
last_avf: activation function for last layer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Residual-Molecular-Mapping-network">Residual Molecular Mapping network<a class="anchor-link" href="#Residual-Molecular-Mapping-network"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MolMapResNet" class="doc_header"><code>MolMapResNet</code><a href="https://github.com/riversdark/molmapnets/tree/master/molmapnets/nets.py#L194" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MolMapResNet</code>(<strong><code>input_shape</code></strong>, <strong><code>num_resnet_blocks</code></strong>=<em><code>8</code></em>, <strong><code>n_outputs</code></strong>=<em><code>1</code></em>, <strong><code>dense_layers</code></strong>=<em><code>[128, 32]</code></em>, <strong><code>dense_avf</code></strong>=<em><code>'relu'</code></em>, <strong><code>last_avf</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><p>molmap_shape: w, h, c
num_resnet_blocks: int
n_outputs: output units
dense_layers: list, how many dense layers and units
dense_avf: activation function for dense layers
last_avf: activation function for last layer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

